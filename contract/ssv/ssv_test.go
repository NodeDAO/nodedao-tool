package ssv

import (
	"github.com/ethereum/go-ethereum/accounts/abi"
	"github.com/ethereum/go-ethereum/common"
	"math/big"
	"strings"
	"testing"
)

func TestRegisterValidatorInputData(t *testing.T) {
	parsed, err := abi.JSON(strings.NewReader(SsvABI))
	if err != nil {
		t.Fatal(err)
	}

	publicKey := common.Hex2Bytes("97c7a9de27db9dc39d811151aef07bbed48b33a253422faeaead935a123ce40c9a3e6a47c9adbfe1f1b5efd404a876d3")
	operatorIds := []uint64{312, 313, 346, 347}
	sharesData := common.Hex2Bytes("b7e7b3ad7d6d054376f56e5f175f8b08a15eb0539b7acea044404412b2fd7698be5233900d61011d9288a9ef7e63754e05e811f2561c6886557aa49ef26ef33c683721d30c32687e5417aadd9ed9f72d1739bb73c19282b8533fbd3b926bfe61922805eb649c91b2b7819d79b58cb503e733bf4cd9d29db8d492fd1fdab5e1519ebc88c31a30adce8eb2fc108048d2d0960295ef6a734e3c8ef2df23f9ed30ace13b204a1c39adfda7197f03e0da40d076d050e50b41f959f61499b6a84fc1bf86253e1689e854b604081afff570fbea91b42eec230f527c0ac615a7290dcb6d051938b91b5b82373fbe8930b0c49c6885a2c9d5adb710a09e25cc79a1aa8ec2cf6010d3a715ea67b7155e1f0213ccab6b403a0f82a971d4e54a55a633dc767791b3f25eed42d089f619f5a36e03ae22088ebba7e3810860f63d5c879356cb43cab37dbcf04a986deb38919aa33d03779ba42a7bf79470288ccd940c08b7ef3f7d445fe41c855483534ec3da366f54ce3180d95f7f8a0aad2f14793ede063993147d38564e34fea97735feb6fb57aa37d93f00cb96094827a3dec6a9153db101af1549ba8e4683a70da4cb180cef5be1e9b4a51f33ba53e580452a95f107e8b6c395dd38091ae591a1de55ba5e8e2b3a533655401431c173aa2f5f195e79d5ab79ed80eef7a4dabfbfd8102666f9049b07c20aec033c1607b2c70c6dbb8d90121984c4185857d7183d5ea7038ce77d71f05746f53215cd88a52b1ab8bd2f712360d16425efcba7ed3c27ded249339b8148e2bbb4b4988d585a4aae1023fe967c7018a37e7eb497a5311bf0a5db6451a13c76c3b7b0a54755323f2ec866d1258cb6b235be6bd6ad62bba5ae0faad6cdffa18d0cfdcf0b4ea7c03e774eaff7ead418574c17e57859510e2964f78c0b324c48b95e360d199bf99a4214afce582a1cd17c4a250c32afa85d7265a260ce982f63c350c2fa836744968e58e10b1f3de013ef343ce2436d319806f25d30d2c101a236273bdb78ea0509c19171c926ac52499e9eac5789aea4dc5763fcda3e8d9540eb5f20451f67f765e80346eb977402a400f471735dfe4dc7d42a97d3b4b1a02a2c1fbf04143b7433184b5a127916ce4ab32670f6400e8e61e9303047951b05e829eb61156ff9c60aff955165ad9519010558acc6226ed1dc02c53ce727f31a9de3c630ba7dd22ca265826960f53db35d0ad018c7032e5d0339f3796ae18d07dee27a5651d85ae89d89e778279dfaf53aeb373fc44f7a34550c4992fab61ab29da99d1474773d8e09550fd1009f14cb3fc02d56ccc5300dbee435018ead68843235720316f0ddc173c069565b7cd0f47e292f26378d16bb1ec54c26cad6eb536de3873a6ea9eb28e809aa6c93769f1ebc897e8a9a094c6a0698fb532e5dbfcdae4be8bb796d642c2d009d5fc19b30e0b03ae1e1c6a0086ccc8d0ae363eb5c834914c8552ee37fb401efb80893258c322e30bdd13987dd337967826287b179b8d3fdb30329d43ca381776c1e5f750695a2b58c802b4eea851e0ac1ff7564bce6b4ea914b22883e3eb8044783135302985403a5cd20f0a333d3b214748be0988a6def1f5675b5f2d24423ace2b04fbbdb14e6a2f4beab54f187e2f950526ae2ce3e0b3585e5bcc395dc59425cf7ae610fa54a5933b8bccb520b6ce3a994a692cb2e4409b799cae657ce6c8714387351793264c613fb99f2b6fb7b9b93c3b0c8bf69ef0f956104227614426d299dfcf53ded83ea0bc776382163195381f257d5546cbe3d2ad1595fc8ed9009f2461e770e78a5acb5a71411bcbeb72b54cdf625066e0cf31d750f96d71dd0eb8848f4dcf6")
	amount := big.NewInt(0).Mul(big.NewInt(100000000000), big.NewInt(1000000000))
	cluster := ISSVNetworkCoreCluster{
		ValidatorCount:  0,
		NetworkFeeIndex: 0,
		Index:           0,
		Active:          true,
		Balance:         big.NewInt(0),
	}

	data, err := parsed.Pack("registerValidator", publicKey, operatorIds, sharesData, amount, cluster)
	if err != nil {
		t.Fatal(err)
	}

	t.Log("0x" + common.Bytes2Hex(data))
}
